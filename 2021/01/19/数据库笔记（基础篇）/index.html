<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>数据库笔记（基础篇） | Hmoji的星露谷</title><meta name="description" content="复试冲冲冲"><meta name="keywords" content="考研,数据库"><meta name="author" content="Hmoji"><meta name="copyright" content="Hmoji"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="数据库笔记（基础篇）"><meta name="twitter:description" content="复试冲冲冲"><meta name="twitter:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F11381381422%2F0.jpg&amp;refer=http%3A%2F%2Finews.gtimg.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1613637812&amp;t=84184afef1c716bb177c16bf4aeb764a"><meta property="og:type" content="article"><meta property="og:title" content="数据库笔记（基础篇）"><meta property="og:url" content="http://yoursite.com/2021/01/19/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%89/"><meta property="og:site_name" content="Hmoji的星露谷"><meta property="og:description" content="复试冲冲冲"><meta property="og:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F11381381422%2F0.jpg&amp;refer=http%3A%2F%2Finews.gtimg.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1613637812&amp;t=84184afef1c716bb177c16bf4aeb764a"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="http://yoursite.com/2021/01/19/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%89/"><link rel="next" title="商品拜物教" href="http://yoursite.com/2020/11/19/%E5%95%86%E5%93%81%E6%8B%9C%E7%89%A9%E6%95%99/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">16</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">17</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#关系数据库"><span class="toc-number">1.</span> <span class="toc-text">关系数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#基本概念"><span class="toc-number">1.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#关系的完整性"><span class="toc-number">1.2.</span> <span class="toc-text">关系的完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#实体完整性"><span class="toc-number">1.2.1.</span> <span class="toc-text">实体完整性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参照完整性"><span class="toc-number">1.2.2.</span> <span class="toc-text">参照完整性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用户自定义完整性"><span class="toc-number">1.2.3.</span> <span class="toc-text">用户自定义完整性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#关系代数"><span class="toc-number">1.3.</span> <span class="toc-text">关系代数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#传统集合运算符"><span class="toc-number">1.3.1.</span> <span class="toc-text">传统集合运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#专门关系运算符"><span class="toc-number">1.3.2.</span> <span class="toc-text">专门关系运算符</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#关系数据库标准语言SQL"><span class="toc-number">2.</span> <span class="toc-text">关系数据库标准语言SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#模式的定义与删除"><span class="toc-number">2.1.</span> <span class="toc-text">模式的定义与删除</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#定义模式"><span class="toc-number">2.1.1.</span> <span class="toc-text">定义模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除模式"><span class="toc-number">2.1.2.</span> <span class="toc-text">删除模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#基本表的定义、删除和修改"><span class="toc-number">2.2.</span> <span class="toc-text">基本表的定义、删除和修改</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#定义基本表"><span class="toc-number">2.2.1.</span> <span class="toc-text">定义基本表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据类型"><span class="toc-number">2.2.2.</span> <span class="toc-text">数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模式与表"><span class="toc-number">2.2.3.</span> <span class="toc-text">模式与表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改基本表"><span class="toc-number">2.2.4.</span> <span class="toc-text">修改基本表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除基本表"><span class="toc-number">2.2.5.</span> <span class="toc-text">删除基本表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#索引的建立和删除"><span class="toc-number">2.3.</span> <span class="toc-text">索引的建立和删除</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#建立索引"><span class="toc-number">2.3.1.</span> <span class="toc-text">建立索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改索引"><span class="toc-number">2.3.2.</span> <span class="toc-text">修改索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除索引"><span class="toc-number">2.3.3.</span> <span class="toc-text">删除索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据字典"><span class="toc-number">2.3.4.</span> <span class="toc-text">数据字典</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据查询"><span class="toc-number">2.4.</span> <span class="toc-text">数据查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#单表查询"><span class="toc-number">2.4.1.</span> <span class="toc-text">单表查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#连接查询"><span class="toc-number">2.4.2.</span> <span class="toc-text">连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#嵌套查询"><span class="toc-number">2.4.3.</span> <span class="toc-text">嵌套查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#集合查询"><span class="toc-number">2.4.4.</span> <span class="toc-text">集合查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基于派生表的查询"><span class="toc-number">2.4.5.</span> <span class="toc-text">基于派生表的查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据更新"><span class="toc-number">2.5.</span> <span class="toc-text">数据更新</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#插入数据"><span class="toc-number">2.5.1.</span> <span class="toc-text">插入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改数据"><span class="toc-number">2.5.2.</span> <span class="toc-text">修改数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改数据-1"><span class="toc-number">2.5.3.</span> <span class="toc-text">修改数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#视图"><span class="toc-number">2.6.</span> <span class="toc-text">视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#定义视图"><span class="toc-number">2.6.1.</span> <span class="toc-text">定义视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除视图"><span class="toc-number">2.6.2.</span> <span class="toc-text">删除视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询视图"><span class="toc-number">2.6.3.</span> <span class="toc-text">查询视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更新视图"><span class="toc-number">2.6.4.</span> <span class="toc-text">更新视图</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库的安全性"><span class="toc-number">3.</span> <span class="toc-text">数据库的安全性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#授权"><span class="toc-number">3.1.</span> <span class="toc-text">授权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#授予"><span class="toc-number">3.1.1.</span> <span class="toc-text">授予</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#收回"><span class="toc-number">3.1.2.</span> <span class="toc-text">收回</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#收据库角色"><span class="toc-number">3.2.</span> <span class="toc-text">收据库角色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#审计"><span class="toc-number">3.3.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库的完整性"><span class="toc-number">4.</span> <span class="toc-text">数据库的完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#实体完整性-1"><span class="toc-number">4.1.</span> <span class="toc-text">实体完整性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参照完整性-1"><span class="toc-number">4.2.</span> <span class="toc-text">参照完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#定义参照完整性"><span class="toc-number">4.2.1.</span> <span class="toc-text">定义参照完整性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#违约处理"><span class="toc-number">4.2.2.</span> <span class="toc-text">违约处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#用户定义完整性"><span class="toc-number">4.3.</span> <span class="toc-text">用户定义完整性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#属性上的约束条件"><span class="toc-number">4.4.</span> <span class="toc-text">属性上的约束条件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#元祖上的约束条件"><span class="toc-number">4.5.</span> <span class="toc-text">元祖上的约束条件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#完整性约束命名子句"><span class="toc-number">4.6.</span> <span class="toc-text">完整性约束命名子句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#断言"><span class="toc-number">4.7.</span> <span class="toc-text">断言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#触发器"><span class="toc-number">4.8.</span> <span class="toc-text">触发器</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><div class="post-bg" id="nav" style="background-image: url(https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F11381381422%2F0.jpg&amp;refer=http%3A%2F%2Finews.gtimg.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1613637812&amp;t=84184afef1c716bb177c16bf4aeb764a)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Hmoji的星露谷</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">数据库笔记（基础篇）</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2021-01-19 16:41:23"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2021-01-19</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2021-01-19 17:07:05"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2021-01-19</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">4.9k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 17 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><p>[TOC]</p>
<p>本文基于王珊、萨师煊编著的《数据库与系统概论（第五版）》</p>
<img src="/" class="lazyload" data-src="https://img-blog.csdnimg.cn/2021011916302655.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NzQxNzMw,size_16,color_FFFFFF,t_70#pic_center"  style="zoom:15%;" />



<h1 id="关系数据库"><a href="#关系数据库" class="headerlink" title="关系数据库"></a>关系数据库</h1><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ol>
<li><p>域(domain)：一组具有相同数据类型的值的集合</p>
<ul>
<li>整数域</li>
<li>实数域</li>
<li>{1,2,3,4}</li>
<li>类似于集合</li>
</ul>
</li>
<li><p>笛卡尔积(cartesian product)</p>
<ul>
<li>域D<del>1</del>={A<del>1</del>,B<del>1</del>}，D<del>2</del>={A<del>2</del>,B<del>2</del>}，D<del>1</del>,D<del>2</del>的笛卡尔积为D<del>1</del>×D<del>2</del>={(A<del>1</del>,A<del>2</del>),(A<del>1</del>,B<del>2</del>),(B<del>1</del>,A<del>2</del>),(B<del>1</del>,B<del>2</del>)}</li>
<li>没有交换律</li>
</ul>
</li>
<li><p>关系(relation)：笛卡尔积的子集在域上的关系，表示为R(D<del>1</del>,D<del>2</del>···D<del>n</del>)</p>
<ul>
<li>n是关系的<strong>目</strong>或<strong>度</strong>(degree)</li>
<li>关系中的行称为元组(tuple)</li>
<li>关系中的列称为属性(attribute)</li>
</ul>
</li>
<li><p>码(key)</p>
<ul>
<li>某一属性组能唯一地标识一个元组，而其子集不行，则称该属性为候选码(candidate key)。</li>
<li>若有多个候选码，则选择其中一个为主码(primary key)</li>
</ul>
</li>
</ol>
<p><strong>关系的每一个分量必须是一个不可分的数据项（不能表中有表）</strong></p>
<p><strong>关系必须是笛卡尔积的真子集才有实际价值</strong></p>
<h2 id="关系的完整性"><a href="#关系的完整性" class="headerlink" title="关系的完整性"></a>关系的完整性</h2><h3 id="实体完整性"><a href="#实体完整性" class="headerlink" title="实体完整性"></a>实体完整性</h3><p>若属性A是基本关系R的主属性，则A不能取空值(null value)</p>
<h3 id="参照完整性"><a href="#参照完整性" class="headerlink" title="参照完整性"></a>参照完整性</h3><ul>
<li>设F是基本关系R的一个或一组属性，但不是关系R的码，K<del>s</del>是基本关系S的主码。如果F和K<del>s</del>相对应，则称F是R的外码(foreign key)，并称基本关系R为参照关系(referencing relation)，基本关系S为被参照关系(referenced relation)或目标关系(target relation)。</li>
<li>F是基本关系R的外码，它与基本关系S的主码K<del>s</del>相对应，则F的值必须为<ul>
<li>或者取空值</li>
<li>或者等于S中某个元组的主码值</li>
</ul>
</li>
</ul>
<h3 id="用户自定义完整性"><a href="#用户自定义完整性" class="headerlink" title="用户自定义完整性"></a>用户自定义完整性</h3><h2 id="关系代数"><a href="#关系代数" class="headerlink" title="关系代数"></a>关系代数</h2><p><img src="/" class="lazyload" data-src="https://img-blog.csdnimg.cn/20210119163057747.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NzQxNzMw,size_16,color_FFFFFF,t_70#pic_center"  alt=""></p>
<h3 id="传统集合运算符"><a href="#传统集合运算符" class="headerlink" title="传统集合运算符"></a>传统集合运算符</h3><p>并（∪，union），差（－，except），交（∩，intersection），笛卡尔积（×，广义笛卡尔积，cartesian product）</p>
<h3 id="专门关系运算符"><a href="#专门关系运算符" class="headerlink" title="专门关系运算符"></a>专门关系运算符</h3><ul>
<li>选择（selection，又叫限制，restriction）：在关系R中选择满足给定条件的元组。</li>
<li>投影（projection）：关系R上的投影是从R中选择出若干属性列组成新关系。</li>
<li>连接（join）：从两个关系的笛卡尔积中选取属性间满足一定条件的元组。<ul>
<li>在连接操作中被舍弃的元组被称为<strong>悬浮元组(dangling tuple)</strong></li>
<li>把悬浮元组也保存在结果关系中，则在其他属性上填空值(NULL)，那么这种连接就叫做<strong>外连接(outer join)</strong>,如果只保留左边关系中的悬浮元组叫<strong>左外连接(left join)</strong>，只保留右侧关系中的悬浮元组就叫做<strong>右外连接(right join)</strong></li>
</ul>
</li>
<li>除（division）：设关系R除以关系S的结果为关系T，则T包含所有在R但不在S中的属性及其值，且T的元组与S的元组的所有组合都在R中。</li>
</ul>
<h1 id="关系数据库标准语言SQL"><a href="#关系数据库标准语言SQL" class="headerlink" title="关系数据库标准语言SQL"></a>关系数据库标准语言SQL</h1><table>
<thead>
<tr>
<th align="center">操作对象/操作方式</th>
<th align="center">创建</th>
<th align="center">删除</th>
<th align="center">修改</th>
</tr>
</thead>
<tbody><tr>
<td align="center">模式</td>
<td align="center">CREATE SCHEMA</td>
<td align="center">DORP SCHEMA</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">表</td>
<td align="center">CREATE TABLE</td>
<td align="center">DORP TABLE</td>
<td align="center">ALTER TABLE</td>
</tr>
<tr>
<td align="center">视图</td>
<td align="center">CREATE VIEW</td>
<td align="center">DROP VIEW</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">索引</td>
<td align="center">CREATE INDEX</td>
<td align="center">DROP INDEX</td>
<td align="center">ALTER INDEX</td>
</tr>
</tbody></table>
<h2 id="模式的定义与删除"><a href="#模式的定义与删除" class="headerlink" title="模式的定义与删除"></a>模式的定义与删除</h2><p>模式类似于C++中的命名空间</p>
<h3 id="定义模式"><a href="#定义模式" class="headerlink" title="定义模式"></a>定义模式</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SCHEMA</span> &lt;模式名&gt; AUTHORIZATION &lt;用户名&gt;</span><br></pre></td></tr></table></figure>

<p>同时<code>CREATE SCHEMA</code>还接受创建基本表、视图，定义授权字句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SCHEMA</span> <span class="keyword">TEST</span> AUTHORIZATION ZHANG</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TAB1(COL1 <span class="built_in">SMALLINT</span>,</span><br><span class="line">                 COL2 <span class="built_in">INT</span>,</span><br><span class="line">                 COL3 <span class="built_in">CHAR</span>(<span class="number">20</span>),</span><br><span class="line">                 COL4 NUMBERIC(<span class="number">10</span>,<span class="number">3</span>),</span><br><span class="line">                 COL5 <span class="built_in">DECIMAL</span>(<span class="number">5</span>,<span class="number">2</span>)</span><br><span class="line">                 );</span><br></pre></td></tr></table></figure>

<h3 id="删除模式"><a href="#删除模式" class="headerlink" title="删除模式"></a>删除模式</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">SCHEMA</span>&lt;模式名&gt;&lt;<span class="keyword">CASCADE</span>|RESTRICT&gt;</span><br></pre></td></tr></table></figure>

<p><code>CASCADE</code>和<code>RESTRICT</code>必选其一。</p>
<ul>
<li><code>CASCADE</code>（级联）：删除模式时把该模式中所有的数据库对象全部删除。</li>
<li><code>RESTRICT</code>（限制）：若该模式中已经定义了下属的数据库对象（如表、视图等），则拒绝该删除语句的执行。</li>
</ul>
<h2 id="基本表的定义、删除和修改"><a href="#基本表的定义、删除和修改" class="headerlink" title="基本表的定义、删除和修改"></a>基本表的定义、删除和修改</h2><h3 id="定义基本表"><a href="#定义基本表" class="headerlink" title="定义基本表"></a>定义基本表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> &lt;表名&gt;（&lt;列名&gt;&lt;数据类型&gt;[列级完整性约束条件]</span><br><span class="line">					[,&lt;列名&gt;&lt;数据类型&gt;[列级完整性约束条件]]</span><br><span class="line">					···</span><br><span class="line">					[,&lt;表级完整性约束条件&gt;]）;</span><br></pre></td></tr></table></figure>

<p>举个例子：建立一个“课程“表Course</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Course</span><br><span class="line">(Cno <span class="built_in">CHAR</span>(<span class="number">4</span>) PRIMARY <span class="keyword">KEY</span>,<span class="comment">/*列级完整性约束条件，Cno是主码*/</span></span><br><span class="line">Cname <span class="built_in">CHAR</span>(<span class="number">40</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,<span class="comment">/*列级完整性约束条件，Cname不能取空值*/</span></span><br><span class="line">Cpno <span class="built_in">CHAR</span>(<span class="number">4</span>),</span><br><span class="line">Ccredit <span class="built_in">SMALLINT</span>,</span><br><span class="line"><span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(Cpno) <span class="keyword">REFERENCES</span> Course(Cno)<span class="comment">/*表级完整性约束条件，Cpno是外码，被参照表是Course，被参照列是Cno*/</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>参照表和被参照表可以是同一个表</p>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><table>
<thead>
<tr>
<th align="center">数据类型</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">CAHR(n),CHARACTER(n)</td>
<td align="center">长度为n的定长字符串</td>
</tr>
<tr>
<td align="center">VARCHAR(n),CHARACTERVARYING(n)</td>
<td align="center">最大长度为n的变长字符串</td>
</tr>
<tr>
<td align="center">CLOB</td>
<td align="center">字符串最大对象</td>
</tr>
<tr>
<td align="center">BLOB</td>
<td align="center">二进制大对象</td>
</tr>
<tr>
<td align="center">INT,INTEGER</td>
<td align="center">长整数（4字节）</td>
</tr>
<tr>
<td align="center">SMALLINT</td>
<td align="center">短整数（2字节）</td>
</tr>
<tr>
<td align="center">BIGINT</td>
<td align="center">大整数（8字节）</td>
</tr>
<tr>
<td align="center">NUMERIC(p,d)</td>
<td align="center">定点数，由p位数字（不包括符号、小数点）组成，小数点后面有d位数字</td>
</tr>
<tr>
<td align="center">DECIMAL(p,d),DEC(p,d)</td>
<td align="center">同NUMERIC</td>
</tr>
<tr>
<td align="center">REAL</td>
<td align="center">取决于机器精度的单精度浮点数</td>
</tr>
<tr>
<td align="center">DOUBLE PRECISION</td>
<td align="center">取决于机器精度的双精度浮点数</td>
</tr>
<tr>
<td align="center">FLOAT(n)</td>
<td align="center">可选精度的浮点数，精度至少为n位数字</td>
</tr>
<tr>
<td align="center">BOOLEAN</td>
<td align="center">逻辑布尔量</td>
</tr>
<tr>
<td align="center">DATE</td>
<td align="center">日期，包含年、月、日，格式为YYYY-MM-DD</td>
</tr>
<tr>
<td align="center">TIME</td>
<td align="center">时间，包含一日的时、分、秒，格式为HH:MM:SS</td>
</tr>
<tr>
<td align="center">TIMESTAMP</td>
<td align="center">时间戳类型</td>
</tr>
<tr>
<td align="center">INTERVAL</td>
<td align="center">时间间隔类型</td>
</tr>
</tbody></table>
<h3 id="模式与表"><a href="#模式与表" class="headerlink" title="模式与表"></a>模式与表</h3><ol>
<li><p>在表中显式地给出模式名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">"S-T"</span>.Student(···);<span class="comment">/*Student所属的模式是S-T*/</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>所创建模式语句中同时创建表</p>
<p>参见“模式的定义与删除”章节</p>
</li>
<li><p>设置所属模式</p>
<p>使用下面的语句可以显示当前搜索路径</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> search_path;</span><br></pre></td></tr></table></figure>

<p>默认值为$user,PUBLIC。意为首先搜索与用户名相同的模式名，否则使用PUBLIC模式。</p>
<p>DBA也可以设置搜索路径</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> search_path <span class="keyword">TO</span> <span class="string">"S-T"</span>,<span class="keyword">PUBLIC</span>;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="修改基本表"><a href="#修改基本表" class="headerlink" title="修改基本表"></a>修改基本表</h3><p>使用<code>ALTER TABLE</code>来修改基本表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span>&lt;表名&gt;</span><br><span class="line">[<span class="keyword">ADD</span> [<span class="keyword">COLUMN</span>] &lt;新列名&gt;&lt;数据类型&gt;[完整性约束]]</span><br><span class="line">[<span class="keyword">ADD</span>&lt;表级完整性约束&gt;]</span><br><span class="line">[<span class="keyword">DROP</span>[<span class="keyword">COLUMN</span>]&lt;列名&gt;[<span class="keyword">CASCADE</span>|RESTRICT]]</span><br><span class="line">[<span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span>&lt;完整性约束&gt;[RESTRICT|<span class="keyword">CASCADE</span>]]</span><br><span class="line">[<span class="keyword">ALTER</span> <span class="keyword">COLUMN</span>&lt;列名&gt;&lt;数据类型&gt;];</span><br></pre></td></tr></table></figure>

<h3 id="删除基本表"><a href="#删除基本表" class="headerlink" title="删除基本表"></a>删除基本表</h3><p>使用<code>DROP TABLE</code>来删除基本表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span>&lt;表名&gt;[RESTRICT|<span class="keyword">CASCADE</span>];</span><br></pre></td></tr></table></figure>

<h2 id="索引的建立和删除"><a href="#索引的建立和删除" class="headerlink" title="索引的建立和删除"></a>索引的建立和删除</h2><p>当数据量比较大时，建立索引可加快查询时间。常见的索引包括<strong>顺序文件上的索引、B+树索引、散列（hash）索引、位图索引等</strong>。详细内容请参照操作系统相关知识。SQL标准中不涉及索引，各个数据库具体使用的索引不尽相同，索引的建立和删除由DBA或表的属主（owner）负责，用户不必也不能显式地选择索引。</p>
<h3 id="建立索引"><a href="#建立索引" class="headerlink" title="建立索引"></a>建立索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">UNIQUE</span>][CLUSTER] <span class="keyword">INDEX</span> &lt;索引名&gt;</span><br><span class="line"><span class="keyword">ON</span> &lt;表名&gt;(&lt;列名&gt;[&lt;<span class="keyword">ASC</span>|<span class="keyword">DESC</span>&gt;][,&lt;列名&gt;[&lt;<span class="keyword">ASC</span>|<span class="keyword">DESC</span>&gt;]]···);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>索引可以建立在该表的一列或多列上。</p>
</li>
<li><p>列明后面还可以指定排列次序<code>ASC</code>为升序，<code>DESC</code>为降序，默认为<code>ASC</code>。</p>
</li>
<li><p><code>UNIQUE</code>表示此索引的每一个索引值只对应唯一的数据记录。</p>
</li>
<li><p><code>CLUSTER</code>表示要建立的索引是聚簇索引</p>
</li>
</ul>
<h3 id="修改索引"><a href="#修改索引" class="headerlink" title="修改索引"></a>修改索引</h3><p>使用下面语句对已经建立的索引重命名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">INDEX</span> &lt;旧索引名&gt; <span class="keyword">RENAME</span> <span class="keyword">TO</span> &lt;新索引名&gt;;</span><br></pre></td></tr></table></figure>

<h3 id="删除索引"><a href="#删除索引" class="headerlink" title="删除索引"></a>删除索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> &lt;索引名&gt;;</span><br></pre></td></tr></table></figure>

<h3 id="数据字典"><a href="#数据字典" class="headerlink" title="数据字典"></a>数据字典</h3><p>数据字典记录了数据库中所有的定义信息。关系数据库系统在执行SQL数据定义语句时，实际上就是在更新数据字典中的响应信息。</p>
<h2 id="数据查询"><a href="#数据查询" class="headerlink" title="数据查询"></a>数据查询</h2><p>数据查询的一般格式为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span>|<span class="keyword">DISTINCT</span>]&lt;目标列表达式&gt;[,&lt;目标列表达式&gt;]···</span><br><span class="line"><span class="keyword">FORM</span> &lt;表名或视图名&gt;[,&lt;表名或视图名&gt;···]|(&lt;<span class="keyword">SELECT</span>语句&gt;)[<span class="keyword">AS</span>]&lt;别名&gt;</span><br><span class="line">[<span class="keyword">WHERE</span> &lt;条件表达式&gt;]</span><br><span class="line">[<span class="keyword">GROUP</span> <span class="keyword">BY</span> &lt;列名<span class="number">1</span>&gt;[<span class="keyword">HAVING</span> &lt;条件表达式&gt;]]</span><br><span class="line">[<span class="keyword">ORDER</span> <span class="keyword">BY</span> &lt;列名<span class="number">2</span>&gt;][<span class="keyword">ASC</span>|<span class="keyword">DESC</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li><code>WHERE</code>子句：条件表达式，从<code>FORM</code>子句指定的基本表、视图或派生表中找出的元组必须满足<code>WHERE</code>子句的约束条件。</li>
<li><code>GROUP BY</code>子句：将结果按照列名1的值进行分组，比如学生成绩单中有多个相同的名字，该子句就可以把这些相同名字的学生合成一个，通常和聚集函数一起使用。<code>HAVING</code>限定输出元组满足的条件。</li>
<li><code>ORDER BY</code>子句：结果表按照列名2的值升序或降序排列。</li>
</ul>
<h3 id="单表查询"><a href="#单表查询" class="headerlink" title="单表查询"></a>单表查询</h3><ul>
<li><p>查询全体学生的学号和姓名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sno,Sname</span><br><span class="line"><span class="keyword">FROM</span> Student;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询全体学生的详细记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Student;</span><br></pre></td></tr></table></figure>

<p><code>*</code>代表所查询表中的全部属性</p>
</li>
<li><p>查询语句中定义列别名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname <span class="keyword">AS</span> <span class="keyword">NAME</span>,<span class="string">'Year of Birth:'</span> <span class="keyword">AS</span> BRITH,<span class="number">24</span>-Sage <span class="keyword">AS</span> BIRTHDAY</span><br><span class="line"><span class="keyword">FROM</span> Student;</span><br></pre></td></tr></table></figure>

<p><em>注意：王珊的书中并没有使用<code>AS</code>，不过我在多方查找资料后觉得这是一种不太规范的的写法，最好还是加上<code>AS</code></em></p>
</li>
<li><p>消除取值重复的行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Sno</span><br><span class="line"><span class="keyword">FROM</span> SC;</span><br></pre></td></tr></table></figure>

<p>不使用<code>DISTINCT</code>则默认为<code>ALL</code>。</p>
</li>
<li><p>条件查询</p>
<p>使用<code>WHERE</code>子句。如查询CS、MA、IS学生的姓名和性别</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname,Ssex</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Sdept <span class="keyword">IN</span>(<span class="string">'CS'</span>,<span class="string">'MA'</span>,<span class="string">'IS'</span>);</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">查询条件</th>
<th align="center">谓词</th>
</tr>
</thead>
<tbody><tr>
<td align="center">比较</td>
<td align="center">=,&gt;,&lt;,&gt;=,&lt;=,!=,&lt;&gt;,!&gt;,!&lt;;NOT+上述比较运算符</td>
</tr>
<tr>
<td align="center">确定范围</td>
<td align="center">BETWEEN AND,NOT BETWEEN AND</td>
</tr>
<tr>
<td align="center">确定集合</td>
<td align="center">IN,NOT IN</td>
</tr>
<tr>
<td align="center">字符匹配^*^</td>
<td align="center">LIKE,NOT LIKE</td>
</tr>
<tr>
<td align="center">空值</td>
<td align="center">IS NULL,NOT IS NULL</td>
</tr>
<tr>
<td align="center">多重条件（逻辑运算）</td>
<td align="center">AND,OR,NOT</td>
</tr>
</tbody></table>
<p><em>*字符匹配可以使用正则表达式</em></p>
</li>
<li><p><code>ORDER BY</code>子句</p>
<p>默认为升序</p>
</li>
<li><p>聚集函数</p>
<table>
<thead>
<tr>
<th align="center">函数名称</th>
<th align="center">函数功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center">COUNT(*)</td>
<td align="center">统计元组的个数</td>
</tr>
<tr>
<td align="center">COUNT([DISTINCT|ALL]&lt;列名&gt;)</td>
<td align="center">统计一列中值的个数</td>
</tr>
<tr>
<td align="center">SUM([DISTINCT|ALL]&lt;列名&gt;)</td>
<td align="center">计算一列值的总和（次列必须是数值型）</td>
</tr>
<tr>
<td align="center">AVG([DISTINCT|ALL]&lt;列名&gt;)</td>
<td align="center">计算一列值的平均值（同上）</td>
</tr>
<tr>
<td align="center">MAX([DISTINCT|ALL]&lt;列名&gt;)</td>
<td align="center">求一列值中的最大值</td>
</tr>
<tr>
<td align="center">MIN([DISTINCT|ALL]&lt;列名&gt;)</td>
<td align="center">求一列值中的最小值</td>
</tr>
</tbody></table>
<p>比如查询选修了课程的学生人数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> Sno)</span><br><span class="line"><span class="keyword">FROM</span> Student;</span><br></pre></td></tr></table></figure>

<p>为避免重复计算学生人数，需要使用<code>DISTINCT</code>。</p>
<ul>
<li>当聚集函数遇到空值时，除<code>COUNT(*)</code>外，都跳过空值。</li>
<li>聚集函数只能用于<code>SELECT</code>子句和<code>GROUP BY</code>中的<code>HAVING</code>子句,<strong>不能用于<code>WHERE</code>子句</strong>。</li>
</ul>
</li>
<li><p><code>GROUP BY</code>子句</p>
<p>求各个课程号及相应的选课人数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Cno,<span class="keyword">COUNT</span>(Sno)</span><br><span class="line"><span class="keyword">FROM</span> SC</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Cno;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h3><ul>
<li><p>等值与非等值连接查询</p>
<p>查询每个学生及其选修课程的情况。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Student.*,SC.*</span><br><span class="line"><span class="keyword">FROM</span> Student,SC</span><br><span class="line"><span class="keyword">WHERE</span> Student.Sno=SC.Sno;</span><br></pre></td></tr></table></figure>

<ul>
<li>在等值连接中把目标列中的重复属性列去掉则为自然连接。</li>
<li>若属性在查询的表中是唯一的，则可以去掉表明前缀</li>
</ul>
</li>
<li><p>自身连接</p>
<p>需要先为表取两个别名<code>FIRST</code>和<code>SECOND</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> FIRST.Cno,SECOND.Cpno</span><br><span class="line"><span class="keyword">FROM</span> Course <span class="keyword">FIRST</span>,Course <span class="keyword">SECOND</span></span><br><span class="line"><span class="keyword">WHERE</span> FIRST.Cpno=SECOND.Cno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>外连接</p>
<p>外链接的概念请参照“关系数据库-关系代数-专门关系运算符”章节</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Student.Sno,Sname,Ssex,Sage,Sdept,Cno,Grade</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> SC <span class="keyword">ON</span> (Student.Sno=SC.Sno);</span><br><span class="line"><span class="comment">/*可以使用`USING`去掉结果中重复的值,两个语句等价*/</span></span><br><span class="line">FROM Student LEFT OUTER JOIN SC USING(Sno);</span><br></pre></td></tr></table></figure>
</li>
<li><p>多表连接</p>
<p>涉及两个以上的表的连接</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Student.Sno,Sname,Cname,Grade</span><br><span class="line"><span class="keyword">FROM</span> Student,SC,Course</span><br><span class="line"><span class="keyword">WHERE</span> Student.Sno=SC.Sno <span class="keyword">AND</span> SC.Cno=Course.Cno;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="嵌套查询"><a href="#嵌套查询" class="headerlink" title="嵌套查询"></a>嵌套查询</h3><ul>
<li><p>带有<code>IN</code>谓词的子查询</p>
<p>查询“刘晨”在同一个系学习的学生</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sno,Sname,Sdept</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Sdept <span class="keyword">IN</span></span><br><span class="line">		(<span class="keyword">SELECT</span> Sdept</span><br><span class="line">        <span class="keyword">FROM</span> Student</span><br><span class="line">        <span class="keyword">WHERE</span> Sname=<span class="string">'刘晨'</span>);</span><br></pre></td></tr></table></figure>

<p>子查询的条件不依赖于父查询，称为<strong>不相关子查询</strong>。</p>
</li>
<li><p>带有比较字符的子查询</p>
<p>找出每个学生超过他自己选修课程平均成绩的课程号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sno,Cno</span><br><span class="line"><span class="keyword">FROM</span> SC <span class="keyword">AS</span> x</span><br><span class="line"><span class="keyword">WHERE</span> Grade&gt;=(<span class="keyword">SELECT</span> <span class="keyword">AVG</span>(Grade)</span><br><span class="line">             <span class="keyword">FROM</span> SC <span class="keyword">AS</span> y</span><br><span class="line">             <span class="keyword">WHERE</span> y.Sno=x.Sno);</span><br></pre></td></tr></table></figure>

<p>参数<code>y.Sno</code>的值是与父查询相关的，这种查询叫做<strong>相关子查询</strong>。</p>
</li>
<li><p>带有<code>ANY(SOME)</code>或<code>ALL</code>谓词的子查询</p>
<p><code>ANY</code>代表查询结果中的某个值，<code>ALL</code>代表查询结果中的所有值。</p>
<p>查询非计算机科学系中比计算机科学系任意一个学生年龄小的学生姓名和年龄</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname,Sage</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Sage&lt;<span class="keyword">ANY</span>(<span class="keyword">SELECT</span> Sage</span><br><span class="line">              <span class="keyword">FROM</span> Student</span><br><span class="line">              <span class="keyword">WHERE</span> Sdept=<span class="string">'CS'</span>)</span><br><span class="line"><span class="keyword">AND</span> Sdept&lt;&gt;<span class="string">'CS'</span>;</span><br></pre></td></tr></table></figure>

<p><code>ANY</code>、<code>ALL</code>谓词与聚集函数、<code>IN</code>谓词之间存在转换关系</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">=</th>
<th align="center">&lt;&gt;或!=</th>
<th align="center">&lt;</th>
<th align="center">&lt;=</th>
<th align="center">&gt;</th>
<th align="center">&gt;=</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ANY</td>
<td align="center">IN</td>
<td align="center">–</td>
<td align="center">&lt;MAX</td>
<td align="center">&lt;=MAX</td>
<td align="center">&gt;MIN</td>
<td align="center">&gt;=MIN</td>
</tr>
<tr>
<td align="center">ALL</td>
<td align="center">–</td>
<td align="center">NOT IN</td>
<td align="center">&lt;MIN</td>
<td align="center">&lt;=MIN</td>
<td align="center">&gt;MAX</td>
<td align="center">&gt;=MAX</td>
</tr>
</tbody></table>
</li>
<li><p>带有<code>EXISTS</code>谓词的子查询</p>
<p><code>EXISTS</code>代表存在量词，其子查询不返回任何数据，只产生”true”或”false”。</p>
<p>查询所有选修了1号课程的学生姓名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span>(<span class="keyword">SELECT</span> *</span><br><span class="line">            <span class="keyword">FROM</span> SC</span><br><span class="line">            <span class="keyword">WHERE</span> Sno=Student.Sno <span class="keyword">AND</span> Cno=<span class="string">'1'</span>)</span><br></pre></td></tr></table></figure>

<p><code>EXISTS</code>引出的子查询，其目标列表表达式通常为<code>*</code>。</p>
<p>与<code>EXISTS</code>相对应的是<code>NO EXISTS</code>，其结果正好与<code>EXISTS</code>相反。</p>
</li>
</ul>
<h3 id="集合查询"><a href="#集合查询" class="headerlink" title="集合查询"></a>集合查询</h3><p>参加集合操作的各查询结果的列数必须相同；对应项的数据类型也必须相同。</p>
<p>集合的操作包括并-<code>UNION</code>，交-<code>INTERSECT</code>，查-<code>EXCEPT</code>.其含义参照“关系数据库-关系代数-专门关系运算符”章节</p>
<p>查询计算机科学系的学生及年龄不大于19岁的学生。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Sdept=<span class="string">'CS'</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Sage&lt;=<span class="number">19</span>;</span><br></pre></td></tr></table></figure>

<p>使用<code>UNION</code>时，系统会自动去掉重复元组。如果要保留则用<code>UNION ALL</code>操作符。</p>
<h3 id="基于派生表的查询"><a href="#基于派生表的查询" class="headerlink" title="基于派生表的查询"></a>基于派生表的查询</h3><p>当子查询出现在<code>FROM</code>子句中时，这个子查询生成的临时<strong>派生表(derived table)</strong>就变成了主查询的查询对象。</p>
<p>找出每个学生超过他自己选修课程平均成绩的课程号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sno,Cno</span><br><span class="line"><span class="keyword">FROM</span> SC,(</span><br><span class="line">    <span class="keyword">SELECT</span> Sno,<span class="keyword">Avg</span>(Grade)</span><br><span class="line">    <span class="keyword">FROM</span> SC </span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> Sno) <span class="keyword">AS</span> Avg_sc(avg_sno,avg_grade)</span><br><span class="line"><span class="keyword">WHERE</span> SC.Sno=Avg_sc.avg_sno <span class="keyword">AND</span> SC.Grade&gt;=Avg_sc.avg_grade;</span><br></pre></td></tr></table></figure>

<h2 id="数据更新"><a href="#数据更新" class="headerlink" title="数据更新"></a>数据更新</h2><h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><ul>
<li><p>插入元组</p>
<p>基本格式为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">INTO</span> &lt;表名&gt;[(&lt;属性列<span class="number">1</span>&gt;[,&lt;属性列<span class="number">2</span>&gt;]···)]</span><br><span class="line"><span class="keyword">VALUES</span>(&lt;常量<span class="number">1</span>&gt;[,&lt;常量<span class="number">2</span>&gt;]···);</span><br></pre></td></tr></table></figure>

<p>插入一条选课记录（‘201215128’，‘1’）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">INTO</span> SC(Sno,Cno)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">'201215128'</span>,<span class="string">'1'</span>);</span><br></pre></td></tr></table></figure>

<p>数据库系统将在新插入记录的未赋值的列上自动赋空值。若<code>INTO</code>后没有指出任何属性值，则要在未赋值的列上明确地给出空值。</p>
</li>
<li><p>插入子查询结果</p>
<p>基本格式为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">INTO</span> &lt;表名&gt;[(&lt;属性列<span class="number">1</span>&gt;[,&lt;属性列<span class="number">2</span>&gt;]···)]</span><br><span class="line">子查询;</span><br></pre></td></tr></table></figure>

<p>对每一个系，求学生的平均年龄，并把结果存入数据库。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">INTO</span> Dept_age(Sdept,Avg_age)</span><br><span class="line"><span class="keyword">SELECT</span> Sdept,<span class="keyword">AVG</span>(Sage)</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Sdept;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h3><p>一般格式为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> &lt;表名&gt;</span><br><span class="line"><span class="keyword">SET</span> &lt;列名&gt;=&lt;表达式&gt;[,&lt;列名&gt;=&lt;表达式&gt;]···</span><br><span class="line">[<span class="keyword">WHERE</span> &lt;条件&gt;];</span><br></pre></td></tr></table></figure>

<p>将计算机科学系全体同学的成绩置零</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> SC</span><br><span class="line"><span class="keyword">SET</span> Grade=<span class="number">0</span></span><br><span class="line"><span class="keyword">WHERE</span> Sno <span class="keyword">IN</span>(<span class="keyword">SELECT</span> Sno</span><br><span class="line">            <span class="keyword">FROM</span> Student</span><br><span class="line">            <span class="keyword">WHERE</span> Sdept=<span class="string">'CS'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="修改数据-1"><a href="#修改数据-1" class="headerlink" title="修改数据"></a>修改数据</h3><p>删除计算机科学系所有学生的选课记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> SC</span><br><span class="line"><span class="keyword">WHERE</span> Sno <span class="keyword">IN</span>(<span class="keyword">SELECT</span> Sno</span><br><span class="line">            <span class="keyword">FROM</span> Student</span><br><span class="line">            <span class="keyword">WHERE</span> Sdept=<span class="string">'CS'</span>);</span><br></pre></td></tr></table></figure>

<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><p>视图是由表（或视图）所导出的表，它是一个虚表，数据库中只保存视图的定义。视图仅在使用时才会运行视图的定义。</p>
<h3 id="定义视图"><a href="#定义视图" class="headerlink" title="定义视图"></a>定义视图</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> &lt;视图名&gt;[(&lt;列名&gt;[,&lt;列名&gt;]···)]</span><br><span class="line"><span class="keyword">AS</span> &lt;子查询&gt;</span><br><span class="line">[<span class="keyword">WITH</span> <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>];</span><br></pre></td></tr></table></figure>

<p>建立信息系学生的视图，并要求进行修改和插入操作时仍保证该视图只有信息系的学生</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> IS_Student</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> Sno,Sname,Sage</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Sdept=<span class="string">'IS'</span></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>;</span><br></pre></td></tr></table></figure>

<p><code>WITH CHECK OPTION</code>子句保证了以后对该视图进行修改时系统自动加上<code>WHERE</code>子句的约束条件。</p>
<h3 id="删除视图"><a href="#删除视图" class="headerlink" title="删除视图"></a>删除视图</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> &lt;视图名&gt;[<span class="keyword">CASCADE</span>];</span><br></pre></td></tr></table></figure>

<h3 id="查询视图"><a href="#查询视图" class="headerlink" title="查询视图"></a>查询视图</h3><p>查询语句和基本表一样。</p>
<p>查询视图时，先从数据字典中取出视图的定义，把定义中的子查询和用户的查询结合起来，转化成等价的对基本表的查询，然后执行修正了的查询。这个过程叫做<strong>视图消解(view resolution)</strong>。</p>
<p><em>注意：在对非行列子集视图的查询要直接对基本表进行。因为在进行视图消解时可能会发生错误。</em></p>
<h3 id="更新视图"><a href="#更新视图" class="headerlink" title="更新视图"></a>更新视图</h3><p>与更新表基本一致。</p>
<p>由于视图消解的存在，有些视图是不可更新的。</p>
<h1 id="数据库的安全性"><a href="#数据库的安全性" class="headerlink" title="数据库的安全性"></a>数据库的安全性</h1><h2 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h2><h3 id="授予"><a href="#授予" class="headerlink" title="授予"></a>授予</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> &lt;权限&gt;[,&lt;权限&gt;]···</span><br><span class="line"><span class="keyword">ON</span> &lt;对象类型&gt;&lt;对象名&gt;[,&lt;对象类型&gt;&lt;对象名&gt;]···</span><br><span class="line"><span class="keyword">TO</span> &lt;用户&gt;[,&lt;用户&gt;]···</span><br><span class="line">[<span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>];</span><br></pre></td></tr></table></figure>

<p><code>WITH GRANT OPTION</code>子句意为该用户还可以把权限授予其他用户。</p>
<p>用户可以是<code>PUBLIC</code>。</p>
<p>不允许循环授权。</p>
<h3 id="收回"><a href="#收回" class="headerlink" title="收回"></a>收回</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> &lt;权限&gt;[,&lt;权限&gt;]···</span><br><span class="line"><span class="keyword">ON</span> &lt;对象类型&gt;&lt;对象名&gt;[,&lt;对象类型&gt;&lt;对象名&gt;]</span><br><span class="line"><span class="keyword">FROM</span> &lt;用户&gt;[,&lt;用户&gt;]···[<span class="keyword">CASCADE</span>|RESTRICT];</span><br></pre></td></tr></table></figure>

<h2 id="收据库角色"><a href="#收据库角色" class="headerlink" title="收据库角色"></a>收据库角色</h2><p>数据库角色是权限的集合。</p>
<p>创建角色格式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">ROLE</span> &lt;角色名&gt;;</span><br></pre></td></tr></table></figure>

<p>给角色授权语句和收回语句和用户一样。</p>
<p>角色也可以授予其他角色和用户。</p>
<h2 id="审计"><a href="#审计" class="headerlink" title="审计"></a>审计</h2><p>对修改SC表结构或修改SC表数据的操作进行审计</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AUDIT <span class="keyword">ALTER</span>,<span class="keyword">UPDATE</span></span><br><span class="line"><span class="keyword">ON</span> CS;</span><br></pre></td></tr></table></figure>

<p>取消对SC表的一切审计</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NOAUDIT <span class="keyword">ALTER</span>,<span class="keyword">UPDATE</span></span><br><span class="line"><span class="keyword">ON</span> SC;</span><br></pre></td></tr></table></figure>

<h1 id="数据库的完整性"><a href="#数据库的完整性" class="headerlink" title="数据库的完整性"></a>数据库的完整性</h1><p>若无显示定义违约处理，违约操作一律拒绝。</p>
<h2 id="实体完整性-1"><a href="#实体完整性-1" class="headerlink" title="实体完整性"></a>实体完整性</h2><p>实体完整性约束即定义<code>PRIMARY KEY</code>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SC</span><br><span class="line">	(Sno <span class="built_in">CHAR</span>(<span class="number">9</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    Cno <span class="built_in">CHAR</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    Grade SAMLLINT,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span>(Sno,Cno)</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>

<h2 id="参照完整性-1"><a href="#参照完整性-1" class="headerlink" title="参照完整性"></a>参照完整性</h2><p>参照完整性是关于外键的约束。</p>
<h3 id="定义参照完整性"><a href="#定义参照完整性" class="headerlink" title="定义参照完整性"></a>定义参照完整性</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SC</span><br><span class="line">	(Sno <span class="built_in">CHAR</span>(<span class="number">9</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    Cno <span class="built_in">CHAR</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    Grade SAMLLINT,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span>(Sno,Cno),</span><br><span class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(Sno) <span class="keyword">REFERENCES</span> Student <span class="comment">/*在表级定义参照完整性*/</span></span><br><span class="line">    );</span><br></pre></td></tr></table></figure>

<h3 id="违约处理"><a href="#违约处理" class="headerlink" title="违约处理"></a>违约处理</h3><p>参照完整性有三种违约处理，为<strong>拒绝(NO ACTION，默认策略)</strong>，<strong>级联(CASCADE)</strong>，<strong>设置位空值</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SC</span><br><span class="line">	(Sno <span class="built_in">CHAR</span>(<span class="number">9</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    Cno <span class="built_in">CHAR</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    Grade SAMLLINT,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span>(Sno,Cno),</span><br><span class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(Sno) <span class="keyword">REFERENCES</span> Student <span class="comment">/*在表级定义参照完整性*/</span></span><br><span class="line">     <span class="keyword">ON</span> <span class="keyword">DELETE</span> [<span class="keyword">CASCADE</span>|<span class="keyword">NO</span> <span class="keyword">ACTION</span>|<span class="keyword">SET</span> <span class="literal">NULL</span>]</span><br><span class="line">     <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span> <span class="comment">/*级联更新*/</span></span><br><span class="line">    );</span><br></pre></td></tr></table></figure>

<h2 id="用户定义完整性"><a href="#用户定义完整性" class="headerlink" title="用户定义完整性"></a>用户定义完整性</h2><h2 id="属性上的约束条件"><a href="#属性上的约束条件" class="headerlink" title="属性上的约束条件"></a>属性上的约束条件</h2><ul>
<li>列值非空（NOT NULL）</li>
<li>列值唯一（UNIQUE）</li>
<li>检查列值是否满足一个条件表达式（CHECK短语）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student</span><br><span class="line">	(Sno <span class="built_in">CHAR</span>(<span class="number">9</span>) PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    Sname <span class="built_in">CHAR</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    Ssex <span class="built_in">CHAR</span>(<span class="number">2</span>) <span class="keyword">CHECK</span>(Ssex <span class="keyword">IN</span> (<span class="string">'男'</span>,<span class="string">'女'</span>)),<span class="comment">/*性别只允许取男或女*/</span></span><br><span class="line">    Sage SAMLLINT,</span><br><span class="line">    Sdept <span class="built_in">CHAR</span>(<span class="number">20</span>)</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>

<h2 id="元祖上的约束条件"><a href="#元祖上的约束条件" class="headerlink" title="元祖上的约束条件"></a>元祖上的约束条件</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Student</span><br><span class="line">	(Sno <span class="built_in">CHAR</span>(<span class="number">9</span>) PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    Sname <span class="built_in">CHAR</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    Ssex <span class="built_in">CHAR</span>(<span class="number">2</span>),</span><br><span class="line">    Sage SAMLLINT,</span><br><span class="line">    Sdept <span class="built_in">CHAR</span>(<span class="number">20</span>),</span><br><span class="line">     <span class="keyword">CHECK</span>(Ssex=<span class="string">'女'</span> <span class="keyword">OR</span> Sname <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">'Ms.%'</span>)<span class="comment">/*定义了元组中Sname和Ssex两个属性值之间的约束条件*/</span></span><br><span class="line">    );</span><br></pre></td></tr></table></figure>

<h2 id="完整性约束命名子句"><a href="#完整性约束命名子句" class="headerlink" title="完整性约束命名子句"></a>完整性约束命名子句</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONTRAINT &lt;完整性约束条件名&gt;&lt;完整性约束条件&gt;</span><br></pre></td></tr></table></figure>

<p>删除使用<code>DROP</code>。</p>
<p>我感觉这个东西没什么大用。</p>
<h2 id="断言"><a href="#断言" class="headerlink" title="断言"></a>断言</h2><p>每次对表进行操作就会触发断言检查，若违反断言则拒绝该操作。</p>
<p>限制课程最多60名学生选修</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">ASSERTION</span> ASSE_SC_DB_NUM</span><br><span class="line">	<span class="keyword">CHECK</span>(<span class="number">60</span>&gt;=(<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*)</span><br><span class="line">              <span class="keyword">FROM</span> Course,SC</span><br><span class="line">              <span class="keyword">WHERE</span> SC.CNO=COURSE.CNO <span class="keyword">AND</span> COURSE.CNAME=<span class="string">'数据库'</span>)</span><br><span class="line">         );</span><br></pre></td></tr></table></figure>

<p>删除断言</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">ASSERTION</span> &lt;断言名&gt;;</span><br></pre></td></tr></table></figure>

<h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2><p>触发器类似于C/C++中的<code>if</code>子句。建立触发器的格式为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> &lt;触发器名&gt;</span><br><span class="line">&#123;<span class="keyword">BEFORE</span>|<span class="keyword">AFTER</span>&#125; &lt;触发事件&gt; <span class="keyword">ON</span> &lt;表名&gt; </span><br><span class="line"><span class="keyword">REFERENCING</span> <span class="keyword">NEW</span>|<span class="keyword">OLD</span> <span class="keyword">ROW</span> <span class="keyword">AS</span> &lt;变量&gt; <span class="comment">/*指出引用的变量*/</span></span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> &#123;<span class="keyword">ROW</span>|<span class="keyword">STATEMENT</span>&#125; <span class="comment">/*定义触发器类型*/</span></span><br><span class="line">[<span class="keyword">WHEN</span> &lt;触发条件&gt;] &lt;触发动作体&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>只有表的拥有者才可以在表上建立触发器。</li>
<li><code>AFTER|BEFORE</code>是触发时机，指明触发器激活时间是在执行触发事件前或后。</li>
<li>触发器类型可定义为行级触发器<code>ROW</code>和语句级触发器<code>STATEMENT</code>。</li>
</ul>
<p>删除触发器</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> &lt;触发器名&gt; <span class="keyword">ON</span> &lt;表名&gt;</span><br></pre></td></tr></table></figure>

<p><em>触发器这一章太复杂了，很多东西我也看不懂，先记着。</em></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Hmoji</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2021/01/19/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%89/">http://yoursite.com/2021/01/19/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%89/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">Hmoji的星露谷</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%80%83%E7%A0%94/">考研</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><div class="post_share"><div class="social-share" data-image="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F11381381422%2F0.jpg&amp;refer=http%3A%2F%2Finews.gtimg.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1613637812&amp;t=84184afef1c716bb177c16bf4aeb764a" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/2020/11/19/%E5%95%86%E5%93%81%E6%8B%9C%E7%89%A9%E6%95%99/"><img class="next_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">商品拜物教</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/04/20/2020年南京航空航天大学计算机考研总结/" title="2020年南京航空航天大学计算机考研总结"><img class="relatedPosts_cover lazyload"data-src="http://n.sinaimg.cn/sinacn19/579/w870h509/20181102/0a67-hnfikve9539154.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-20</div><div class="relatedPosts_title">2020年南京航空航天大学计算机考研总结</div></div></a></div><div class="relatedPosts_item"><a href="/2020/04/22/javaweb学习笔记-通过JDBC连接数据库/" title="javaweb学习笔记--通过JDBC连接数据库"><img class="relatedPosts_cover lazyload"data-src="http://pic.netbian.com/uploads/allimg/200319/005608-15845505687dfd.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-22</div><div class="relatedPosts_title">javaweb学习笔记--通过JDBC连接数据库</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="lv-container" data-id="city" data-uid="MTAyMC80OTc0My8yNjIzNA=="><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
})(document, 'script');</script></div></div></article></main><footer id="footer" style="background-image: url(https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F11381381422%2F0.jpg&amp;refer=http%3A%2F%2Finews.gtimg.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1613637812&amp;t=84184afef1c716bb177c16bf4aeb764a)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Hmoji</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/third-party/click_heart.js"></script><script>if (document.getElementsByClassName('mermaid').length) {
  loadScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js',function () {
    mermaid.initialize({
      theme: 'default',
  })
})
}</script></body></html>